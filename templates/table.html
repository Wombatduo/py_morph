{% extends 'base.html' %}

{% block title %}Verb tabler{% endblock %}
{% block heading %}Таблица глаголов{% endblock %}

{% block script %}
    <script>
        function get_verb_form_by_ajax(form_data, post_url, request_method, id) {
            console.log(form_data);
            $.ajax({
                url: post_url,
                type: request_method,
                data: form_data
            }).done(function (data) {
                console.log("verb form is " + data.form);
                $("#" + id).html(data.form);
            });
        }

        $(document).ready(function () {
            $("form").submit(function () {
                var post_url = $(this).attr("action"); //get form action url
                var request_method = $(this).attr("method"); //get form HTTP method
                for (i = 1; i < 4; i++) {
                    $(this).find("[name=tense]").val(i);
                    var form_data = $(this).serialize(); //Encode form elements for submission
                    get_verb_form_by_ajax(form_data, post_url, request_method, i);
                }
            });
            $("form").submit();
        });
    </script>
{% endblock %}

{% block header %}
    <P color="red">Позволяет получить таблицу форм глагола.</P>
    <H2 onmouseover="javascript: $('h2').css('text-decoration','underline')"
        onmouseout="javascript: $('h2').css('text-decoration','none')"
        onmousedown="javascript: $('h2').css('color','red')"
        onmouseup="javascript: f = function(){$('h2').css('color','black')}; setTimeout(f, 1000)"
    >Для использования сервиса</H2>
    <UL>
        <LI>Укажите инфинитив</LI>
    </UL>
{% endblock %}

{% block content %}
    <FORM onsubmit="return false;" action="/morph/do" method="post" target="result">
        <label for="lang">Язык</label>
        <select onchange="$('#infinitive').val($('#lang option:selected').attr('is'));$('form').submit()" tabindex="2"
                id="lang" name="lang">
            {% for lang in langs %}
                <option value="{{ lang }}" is="{{ verbs[lang] }}">{{ langs[lang] }}</option>
            {% endfor %}
        </select><br/><br/><br/>
        <label for="infinitive">Инфинитив</label>
        <input onchange="$('form').submit()" type="text" id="infinitive" name="infinitive" tabindex="1" value="be"/>

        <select onchange="$('form').submit()" style="display: none" tabindex="2" id="person" name="person">
            <option value="1" selected="selected">первое</option>
            <option value="2">второе</option>
            <option value="3">третье</option>
        </select>

        <select onchange="$('form').submit()" style="display: none" tabindex="3" id="number" name="number">
            <option value="1" selected="selected">Ед</option>
            <option value="2">Мн</option>
        </select>

        <input type='hidden' name='tense' value='1'/>

        </fieldset>
    </FORM>

    <p>Формы:</p>
    <TABLE style="border-collapse: collapse">
        <TR>
            {% for tense in tenses %}
                <TD style="border: 1px solid blue; padding: 0.5em; font-weight: bold">{{ tense }} </TD>
            {% endfor %}
        </TR>
        <TR>
            {% for tense in tenses %}
                <TD style="border: 1px solid blue; padding: 0.5em">
                    <span class="verb" id="{{ tense.value }}"></span>
                </TD>
            {% endfor %}
        </TR>
    </TABLE>


{% endblock %}